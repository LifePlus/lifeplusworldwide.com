---
import { fetchMenuItems } from '../datocms.mjs'
import get from 'just-safe-get'
import BaseLayout from './BaseLayout.astro'
import TopNav from '../components/TopNav.astro'
import Footer from '../components/Footer.astro'
import Progress from '../components/Progress.astro'
const { pageId, locales, locale } = Astro.props

const menuItemData = await fetchMenuItems(locale)
const allMenuItems = get(menuItemData, 'data.allMenuItems', [])
const slugFromId = (id) => {
  const menuItem = allMenuItems.find(item => item.page?.id === id);
  return menuItem?.label || '';
};

---

<BaseLayout locale={locale}>
  <Fragment slot="head">
    <slot name="head" />
  </Fragment>
  <div id="menu-container"></div>
  <div id="wrapper" class="bg-white text-black font-sans antialiased min-h-screen flex flex-col justify-between" data-page-id={pageId}>
    <TopNav currentId={pageId} locale={locale} />
    <div class="bg-brand-primary text-white">
      {slugFromId(pageId) === 'Contact' && (
        <h1 class="m-5 font-medium">“LifePlus and its affiliated schools and office will be closed for the Winter Break from December 21st through January 5th.  Any requests will be addressed upon our return to office on January 6th.  Merry Christmas and Happy New Year from LifePlus.”</h1>
      )}
    </div>
    <main class="flex-1 relative z-0">
      <slot />
    </main>
    <Footer />
    <Progress />
  </div>
</BaseLayout>
